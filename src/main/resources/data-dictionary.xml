<?xml version="1.0" encoding="UTF-8"?>
<data-dictionary>
	<tables>
		<table name="persistent_logins" description="This table remembers the user session">
			<columns>
				<column name="username" type="varchar(64)" null="false"/>
				<column name="series" type="varchar(64)" null="false" primary-key="true"/>
				<column name="token" type="varchar(64)" null="false"/>
				<column name="last_used" type="timestamp" null="false"/>
			</columns>
		</table>
		<table name="rm_usertype" description="There are two types of user as of now, i) Tenant, ii) Owner">
			<columns>
				<column name="typeid" type="bigserial" null="false" primary-key="true"/>
				<column name="type" type="varchar(16)" null="false" unique-key="true"/>
			</columns>
		</table>
		<table name="rm_users" description="Stores user information">
			<columns>
				<column name="userid" type="bigserial" null="false" primary-key="true"/>
				<column name="email" type="varchar(256)" null="false"/>
				<column name="password" type="varchar(1024)" null="false"/>
				<column name="creationtime" type="bigint" null="false"/>
				<column name="verified" type="boolean" null="false"/>
				<column name="typeid" type="bigint" null="false" foreign-key="true" reference-table="rm_usertype" reference-column="typeid"/>
			</columns>
		</table>
		<table name="rm_userverification" description="Stores user verification and reset tokens">
			<columns>
				<column name="userid" type="bigint" null="false" primary-key="true" foreign-key="true" reference-table="rm_users" reference-column="userid" delete-cascade="true"/>
				<column name="type" type="int" null="false" primary-key="true" allowed-values="1,2"/>
				<column name="token" type="varchar(32)" null="false"/>
				<column name="creationtime" type="bigint" null="false"/>
			</columns>
		</table>
		<table name="rm_property" description="Stores information about property details such as property name, type, address">
			<columns>
				<column name="propertyid" type="bigserial" null="false" primary-key="true"/>
				<column name="propertyname" type="varchar(64)" null="false"/>
				<column name="propertytype" type="varchar(16)" null="false" allowed-values="HOUSE,APPARTMENT"/>
				<column name="userid" type="bigint" null="false" foreign-key="true" reference-table="rm_users" reference-column="userid" delete-cascade="true"/>
				<column name="creationtime" type="bigint" null="false"/>
				<column name="addressline_1" type="varchar(128)" null="false"/>
				<column name="addressline_2" type="varchar(128)" null="false"/>
				<column name="city" type="varchar(64)" null="false"/>
				<column name="postal" type="varchar(16)" null="false"/>
				<column name="propertysearch_tsv" type="tsvector" null="true"/>
			</columns>
		</table>
		<table name="rm_propertydetails" description="Stores property information such as area, rent, capacity and so on">
			<columns>
				<column name="propertyid" type="bigint" null="false" foreign-key="true" reference-table="rm_property" reference-column="propertyid" delete-cascade="true"/>
				<column name="propertydetailsid" type="bigserial" null="false" primary-key="true"/>
				<column name="capacity" type="int" null="false"/>
				<column name="area" type="float(2)" null="false"/>
				<column name="rent" type="float(2)" null="false"/>
				<column name="occupied" type="int" default-value="0"/>
			</columns>
		</table>
		<table name="rm_apartmentpropertydetails" description="Stores apartment such as door number and floor number">
			<columns>
				<column name="apartmentpropertydetailsid" type="bigint" null="false" unique-key="true" foreign-key="true" reference-table="rm_propertydetails" reference-column="propertydetailsid" delete-cascade="true"/>
				<column name="doorno" type="varchar(8)" null="false"/>
				<column name="floorno" type="int" null="false"/>
			</columns>
		</table>
		<table name="rm_tenant" description="Stores tenants information">
			<columns>
				<column name="tenantuserid" type="bigint" null="false" foreign-key="true" reference-table="rm_users" reference-column="userid" delete-cascade="true"/>
				<column name="tenantid" type="bigserial" null="false" primary-key="true"/>
				<column name="firstname" type="varchar(128)" null="false"/>
				<column name="lastname" type="varchar(128)" null="false"/>
				<column name="email" type="varchar(128)" null="false"/>
				<column name="dob" type="varchar(64)" null="false"/>
				<column name="nationality" type="char(3)" null="false"/>
			</columns>
		</table>
		<table name="rm_contractstatus" description="Stores contract status i) NOCONTRACT, ii) INITIATED, iii) OWNERSIGNED, iv) TENANTSIGNED, v) TERMINATED">
			<columns>
				<column name="contractstatusid" type="bigserial" null="false" primary-key="true"/>
				<column name="contractstatus" type="varchar(16)" null="false" unique-key="true"/>
			</columns>
		</table>
		<table name="rm_lease" description="Stores lease information">
			<columns>
				<column name="leaseid" type="bigserial" null="false" primary-key="true"/>
				<column name="leasetenantid" type="bigserial" null="false" foreign-key="true" reference-table="rm_tenant" reference-column="tenantid" delete-cascade="true"/>
				<column name="tenantspropertydetailid" type="bigint" null="false" foreign-key="true" reference-table="rm_propertydetails" reference-column="propertydetailsid" delete-cascade="true"/>
				<column name="movein" type="bigint" null="false"/>
				<column name="moveout" type="bigint" null="false"/>
				<column name="occupants" type="int" null="false"/>
				<column name="rent" type="float(2)" null="false"/>
				<column name="contractid" type="varchar(32)" null="true"/>
				<column name="statusid" type="bigint" foreign-key="true" reference-table="rm_contractstatus" reference-column="contractstatusid" delete-cascade="true" null="false"/>
			</columns>
		</table>
	</tables>
	<default-values>
		<default-value table="rm_usertype">
			<default-row type="TENANT"/>
			<default-row type="OWNER"/>
		</default-value>
		<default-value table="rm_contractstatus">
			<default-row contractstatus="NOCONTRACT"/>
			<default-row contractstatus="INITIATED"/>
			<default-row contractstatus="OWNERSIGNED"/>
			<default-row contractstatus="TENANTSIGNED"/>
			<default-row contractstatus="TERMINATED"/>
		</default-value>
	</default-values>
</data-dictionary>