<?xml version="1.0" encoding="UTF-8"?>
<security>
	<regexes>
		<regex name="alphanumeric" pattern="^[a-zA-Z0-9]+$"/>
		<regex name="cleartext" pattern="^[a-zA-Z0-9_()&amp;\\s]+$"/>
		<regex name="email" pattern="^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$"/>
		<regex name="password" pattern="^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[!@#$%^&amp;*]).{8,64}$"/>
		<regex name="type" pattern="^(TENANT|OWNER)$"/>
		<regex name="csrf" pattern="^[a-z0-9/-]+$"/>
		<regex name="notallowedchars" pattern="^[^`~.&gt;&lt;&quot;:{}=+]+$"/>
		<regex name="notallowedcharsandnums" pattern="^[^`~.&gt;&lt;&quot;:{}=+0-9]+$"/>
		<regex name="postalcode" pattern="^[0-9]{5}$"/>
		<regex name="naturalnumber" pattern="^[1-9]+[0-9]*$"/>
		<regex name="wholenumber" pattern="^[0-9]+$"/>
		<regex name="propertytype" pattern="^(HOUSE|APPARTMENT)$"/>
	</regexes>	
	<templates>
		<template name="test">
			<parameters>
				<parameter name="test_1" regex="cleartext" max-length="128" required="true"/>
				<parameter name="test_2" regex="email" max-length="64" required="true"/>
				<parameter name="test" type="object" template="test_1" requried="true"/>
			</parameters>
		</template>
		<template name="test_1">
			<parameters>
				<parameter name="test_3" regex="cleartext" max-length="128" required="true"/>
				<parameter name="test_4" regex="email" max-length="64" required="true"/>
			</parameters>
		</template>
		<template name="addresstemp">
			<parameters>
				<parameter name="line_1" regex="notallowedchars" max-length="64" required="true"/>
				<parameter name="line_2" regex="notallowedchars" max-length="64" required="true"/>
				<parameter name="postalcode" regex="postalcode" required="true"/>
				<parameter name="city" regex="notallowedcharsandnums" max-length="64" required="true"/>
			</parameters>
		</template>
		<template name="propertydetailtemp">
			<parameters>
				<parameter name="area" regex="naturalnumber" max-length="10" required="true"/>
				<parameter name="rent" regex="naturalnumber" max-length="10" required="true"/>
				<parameter name="capacity" regex="naturalnumber" max-length="6" required="true"/>
			</parameters>
		</template>
		<template name="unittemp">
			<parameters>
				<parameter name="area" regex="naturalnumber" max-length="10" required="true"/>
				<parameter name="rent" regex="naturalnumber" max-length="10" required="true"/>
				<parameter name="capacity" regex="naturalnumber" max-length="6" required="true"/>
				<parameter name="doorno" regex="alphanumeric" max-length="4" required="true"/>
				<parameter name="floorno" regex="wholenumber" max-length="4" required="true"/>
			</parameters>
		</template>
	</templates>
	<urls>
		<url value="/login" method="get" authentication="false"/>
		<url value="/login" method="post" authentication="false">
			<parameters>
				<parameter name="email" regex="email" required="true"/>
				<parameter name="password" regex="password" required="true"/>
			</parameters>
		</url>
		<url value="/home" method="get" authentication="false"/>
		<url value="/register" method="get" authentication="false"/>
		<url value="/register" method="post" authentication="false">
			<parameters>
				<parameter name="email" regex="email" max-length="64" required="true"/>
				<parameter name="password" regex="password" min-length="8" max-length="64" required="true"/>
				<parameter name="confirmpassword" regex="password" min-length="8" max-length="64" required="true"/>
				<parameter name="usertype.type" regex="type" required="true"/>
			</parameters>
		</url>
		<url value="/verify" method="get" authentication="false">
			<parameters>
				<parameter name="token" regex="alphanumeric" required="true"/>
			</parameters>
		</url>
		<url value="/reset" method="get" authentication="false">
			<parameters>
				<parameter name="token" regex="alphanumeric"/>
			</parameters>
		</url>
		<url value="/reset" method="post" authentication="false">
			<parameters>
				<parameter name="email" regex="email" max-length="64" required="true"/>
			</parameters>
		</url>
		<url value="/reset" method="put" authentication="false">
			<parameters>
				<parameter name="token" regex="alphanumeric" required="true"/>
				<parameter name="password" regex="password" required="true"/>
				<parameter name="confirmpassword" regex="password" required="true"/>
			</parameters>
		</url>
		<url value="/api/property/house" method="post" authentication="false">
			<parameters>
				<parameter name="name" regex="notallowedchars" max-length="64" required="true"/>
				<parameter name="address" type="object" template="addresstemp" required="true"/>
				<parameter name="propertytype" regex="propertytype" required="true"/>
				<parameter name="propertydetails" type="object" template="propertydetailtemp" required="true"/>
			</parameters>
		</url>
		<url value="/api/property/appartment" method="post" authentication="false">
			<parameters>
				<parameter name="name" regex="notallowedchars" max-length="64" required="true"/>
				<parameter name="address" type="object" template="addresstemp" required="true"/>
				<parameter name="propertytype" regex="propertytype" required="true"/>
				<parameter name="units" type="array" template="unittemp" required="true"/>
			</parameters>
		</url>
		<url value="/check" method="post" authentication="true"/>
	</urls>
</security>
